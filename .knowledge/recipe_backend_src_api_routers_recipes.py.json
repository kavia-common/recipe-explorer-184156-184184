{"is_source_file": true, "format": "Python", "description": "This file defines API routes using FastAPI for managing recipes, including listing, creating, retrieving, updating, deleting, and rating recipes. It interacts with SQLAlchemy models and schemas to handle recipe data and filters.", "external_files": ["src.api.deps", "src.db", "src.db.models", "src.schemas.recipe"], "external_methods": ["get_current_active_user", "pagination_params", "get_db", "Recipe", "RecipeRating", "User", "RatingCreate", "RecipeCreate", "RecipeOut", "RecipeUpdate"], "published": ["router"], "classes": [{"name": "Recipe", "description": "SQLAlchemy model representing a recipe."}, {"name": "RecipeRating", "description": "SQLAlchemy model representing a user's rating of a recipe."}, {"name": "User", "description": "SQLAlchemy model representing a user."}], "methods": [{"name": "_apply_filters( query, search: Optional[str], tags: Optional[List[str]], cuisine: Optional[str], difficulty: Optional[str], min_time: Optional[int], max_time: Optional[int], )", "description": "Applies optional filters to the recipe query based on search parameters, tags, cuisine, difficulty, and time constraints.", "scope": "", "scopeKind": ""}, {"name": "list_recipes( search: Optional[str] = None, tags: Optional[List[str]] = Query(default=None), cuisine: Optional[str] = None, difficulty: Optional[str] = None, min_time: Optional[int] = None, max_time: Optional[int] = None, sort: Optional[str] = \"newest\", page: Optional[int] = 1, page_size: Optional[int] = 20, db: Session = Depends(get_db), )", "description": "Retrieves and returns a paginated list of recipes with optional filters and sorting.", "scope": "", "scopeKind": ""}, {"name": "create_recipe( recipe: RecipeCreate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )", "description": "Creates a new recipe associated with the current user.", "scope": "", "scopeKind": ""}, {"name": "get_recipe(recipe_id: int, db: Session = Depends(get_db))", "description": "Fetches a recipe by its ID.", "scope": "", "scopeKind": ""}, {"name": "update_recipe( recipe_id: int, data: RecipeUpdate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )", "description": "Updates an existing recipe if the current user is the owner.", "scope": "", "scopeKind": ""}, {"name": "delete_recipe( recipe_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )", "description": "Deletes a recipe if the current user is the owner.", "scope": "", "scopeKind": ""}, {"name": "rate_recipe( recipe_id: int, rating: RatingCreate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )", "description": "Creates or updates a rating for a recipe by the current user and recalculates the average rating.", "scope": "", "scopeKind": ""}], "calls": ["db.query", "db.add", "db.commit", "db.refresh", "func.lower", "func.cast", "func.like", "func.avg", "get_current_active_user", "pagination_params"], "search-terms": ["FastAPI recipes router", "recipe filters", "recipe creation endpoint", "recipe rating", "recipe update and delete", "SQLAlchemy recipe models"], "state": 2, "file_id": 16, "knowledge_revision": 42, "git_revision": "05a11c8444f688c46fddfe28a69b2aada9555e1c", "revision_history": [{"35": ""}, {"40": "05a11c8444f688c46fddfe28a69b2aada9555e1c"}, {"42": "05a11c8444f688c46fddfe28a69b2aada9555e1c"}], "ctags": [{"_type": "tag", "name": "_apply_filters", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def _apply_filters($/", "language": "Python", "kind": "function", "signature": "( query, search: Optional[str], tags: Optional[List[str]], cuisine: Optional[str], difficulty: Optional[str], min_time: Optional[int], max_time: Optional[int], )"}, {"_type": "tag", "name": "create_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def create_recipe($/", "language": "Python", "kind": "function", "signature": "( recipe: RecipeCreate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "delete_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def delete_recipe($/", "language": "Python", "kind": "function", "signature": "( recipe_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "get_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def get_recipe(recipe_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(recipe_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_recipes", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def list_recipes($/", "language": "Python", "kind": "function", "signature": "( search: Optional[str] = None, tags: Optional[List[str]] = Query(default=None), cuisine: Optional[str] = None, difficulty: Optional[str] = None, min_time: Optional[int] = None, max_time: Optional[int] = None, sort: Optional[str] = \"newest\", page: Optional[int] = 1, page_size: Optional[int] = 20, db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "rate_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def rate_recipe($/", "language": "Python", "kind": "function", "signature": "( recipe_id: int, rating: RatingCreate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^router = APIRouter(prefix=\"\\/recipes\", tags=[\"recipes\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184156-184184/recipe_backend/src/api/routers/recipes.py", "pattern": "/^def update_recipe($/", "language": "Python", "kind": "function", "signature": "( recipe_id: int, data: RecipeUpdate, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db), )"}], "hash": "8be01376b5f350a1a96394c369690c42", "format-version": 4, "code-base-name": "recipe_backend", "filename": "recipe_backend/src/api/routers/recipes.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/recipes\", tags=[\"recipes\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}